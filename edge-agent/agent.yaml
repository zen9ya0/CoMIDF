agent:
  id: "edge-ap01"
  tenant_id: "TENANT-12345"
  site: "hq-taipei"
  timezone: "Asia/Taipei"

uplink:
  mssp_url: "https://mssp.example.com"
  fal_endpoint: "/api/fal/uer"
  token: "<API_TOKEN>"
  tls:
    mtls: true
    ca_cert: "/etc/agent/ca.pem"
    cert: "/etc/agent/agent.pem"
    key: "/etc/agent/agent.key"
  retry:
    backoff_ms: [200, 500, 1000, 2000]
    max_retries: 8

buffer:
  backend: "sqlite"
  path: "/var/lib/edge-agent/buffer.db"
  max_mb: 2048
  flush_batch: 500

privacy:
  id_salt: "SALT-ROTATE-2025Q4"
  strip_fields: ["usernames", "urls", "payload"]

agents:
  http:
    enabled: true
    pcap: "/dev/net/tap0"
    thresholds:
      score_alert: 0.7
  mqtt:
    enabled: true
    source: "tcp://127.0.0.1:1883"
    thresholds:
      score_alert: 0.65
  coap:
    enabled: false
    thresholds:
      score_alert: 0.60
  zigbee:
    enabled: false
    coordinator: "tcp://127.0.0.1:8484"
    thresholds:
      score_alert: 0.70
  quic:
    enabled: false
    port: 443
    thresholds:
      score_alert: 0.75
  modbus:
    enabled: false
    port: 502
    thresholds:
      score_alert: 0.80

metrics:
  prometheus_port: 9108

logging:
  level: "info"
  json: true

